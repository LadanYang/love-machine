<!DOCTYPE html>
<html lang="zh">
<head>
  <meta charset="UTF-8">
  <title>名字反应时实验</title>
  <style>
    body { font-family: Arial, sans-serif; text-align: center; padding: 40px; }
    #task, #result { display: none; }
    button { padding: 10px 20px; margin: 20px; font-size: 18px; }
  </style>
</head>
<body>
  <h1>名字选择实验</h1>
  <div id="setup">
    <p>请输入两个你同样熟悉的名字：</p>
    <input id="name1" placeholder="名字 1">
    <input id="name2" placeholder="名字 2">
    <button onclick="startTask()">开始实验</button>
  </div>

  <div id="task">
    <p id="prompt"></p>
    <button id="btnLeft" onclick="respond(0)"></button>
    <button id="btnRight" onclick="respond(1)"></button>
  </div>

  <div id="result">
    <h2>结果</h2>
    <p id="final"></p>
  </div>

  <script>
    let names = [];
    let trials = [];
    let currentTrial = 0;
    let startTime;
    let responses = [];

    function startTask() {
      const n1 = document.getElementById("name1").value.trim();
      const n2 = document.getElementById("name2").value.trim();
      if (!n1 || !n2) { alert("请输入两个名字！"); return; }

      names = [n1, n2];
      // 生成 10 次试次
      trials = Array.from({length: 10}, () => Math.floor(Math.random() * 2));

      document.getElementById("setup").style.display = "none";
      document.getElementById("task").style.display = "block";

      nextTrial();
    }

    function nextTrial() {
      if (currentTrial >= trials.length) { finish(); return; }
      const target = trials[currentTrial];
      document.getElementById("prompt").innerText = "请尽快选择：" + names[target];
      document.getElementById("btnLeft").innerText = names[0];
      document.getElementById("btnRight").innerText = names[1];
      startTime = Date.now();
    }

    function respond(choice) {
      const rt = Date.now() - startTime;
      const target = trials[currentTrial];
      const correct = (choice === target);
      responses.push({ trial: currentTrial+1, rt, correct });
      currentTrial++;
      nextTrial();
    }

    function finish() {
      document.getElementById("task").style.display = "none";
      document.getElementById("result").style.display = "block";

      // 计算每个名字的平均反应时和准确率
      let stats = [ {rt:0, correct:0, count:0}, {rt:0, correct:0, count:0} ];
      responses.forEach((r,i) => {
        const target = trials[i];
        stats[target].rt += r.rt;
        stats[target].correct += r.correct ? 1 : 0;
        stats[target].count++;
      });

      const avg = stats.map(s => ({
        rt: s.rt / s.count,
        acc: s.correct / s.count
      }));

      let winner = avg[0].rt * (1-avg[0].acc) < avg[1].rt * (1-avg[1].acc) ? names[0] : names[1];

      document.getElementById("final").innerText = 
        `更显著的名字是：${winner}\n\n详细结果：\n${names[0]} - 平均RT: ${avg[0].rt.toFixed(1)}ms, 准确率: ${(avg[0].acc*100).toFixed(1)}%\n${names[1]} - 平均RT: ${avg[1].rt.toFixed(1)}ms, 准确率: ${(avg[1].acc*100).toFixed(1)}%`;
    }
  </script>
</body>
</html>
